<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MC SELLING | Smart Shopping & Custom Prints</title>
    <!-- Fonts & Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary: #2563eb;
            --secondary: #f59e0b;
            --dark: #1e293b;
            --light: #f8fafc;
            --white: #ffffff;
            --gray: #94a3b8;
            --danger: #ef4444;
            --success: #10b981;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --radius: 8px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; }
        
        body { background-color: var(--light); color: var(--dark); line-height: 1.6; padding-bottom: 60px; }
        
        a { text-decoration: none; color: inherit; cursor: pointer; }
        ul { list-style: none; }
        img { max-width: 100%; display: block; }
        button { cursor: pointer; border: none; font-family: inherit; }

        /* --- UI Components --- */
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        .btn { padding: 10px 20px; border-radius: var(--radius); font-weight: 600; transition: 0.3s; display: inline-flex; align-items: center; gap: 8px; }
        .btn-primary { background: var(--primary); color: var(--white); }
        .btn-primary:hover { background: #1d4ed8; }
        .btn-secondary { background: var(--secondary); color: var(--white); }
        .btn-secondary:hover { background: #d97706; }
        .btn-danger { background: var(--danger); color: var(--white); }
        .btn-outline { border: 2px solid var(--primary); color: var(--primary); background: transparent; }
        .btn-outline:hover { background: var(--primary); color: var(--white); }

        /* --- Header --- */
        header { background: var(--white); box-shadow: var(--shadow); position: sticky; top: 0; z-index: 1000; }
        .navbar { display: flex; justify-content: space-between; align-items: center; height: 70px; }
        .logo { font-size: 1.5rem; font-weight: 700; color: var(--primary); cursor: pointer; }
        .logo span { color: var(--secondary); }
        .nav-links { display: flex; gap: 20px; }
        .nav-links a { font-weight: 500; transition: 0.3s; }
        .nav-links a:hover, .nav-links a.active { color: var(--primary); }
        .mobile-toggle { display: none; font-size: 1.5rem; }

        /* --- Views Management --- */
        .view { display: none; padding: 40px 0; animation: fadeIn 0.4s ease; }
        .view.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- Home View --- */
        .hero { background: linear-gradient(135deg, var(--primary), #1e40af); color: var(--white); padding: 60px 0; border-radius: var(--radius); text-align: center; margin-bottom: 40px; }
        .hero h1 { font-size: 2.5rem; margin-bottom: 10px; }
        .hero p { margin-bottom: 20px; opacity: 0.9; }
        
        .section-title { font-size: 1.8rem; margin-bottom: 20px; border-left: 5px solid var(--secondary); padding-left: 15px; }
        
        .category-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px; margin-bottom: 40px; }
        .cat-card { background: var(--white); padding: 20px; text-align: center; border-radius: var(--radius); box-shadow: var(--shadow); transition: 0.3s; border: 1px solid #e2e8f0; cursor: pointer; }
        .cat-card:hover { transform: translateY(-5px); border-color: var(--primary); }
        .cat-card i { font-size: 2rem; color: var(--primary); margin-bottom: 10px; }

        /* --- Shop View --- */
        .toolbar { display: flex; flex-wrap: wrap; gap: 15px; justify-content: space-between; margin-bottom: 30px; background: var(--white); padding: 15px; border-radius: var(--radius); box-shadow: var(--shadow); }
        .search-box { flex: 1; min-width: 250px; position: relative; }
        .search-box input { width: 100%; padding: 10px 10px 10px 40px; border: 1px solid #cbd5e1; border-radius: var(--radius); outline: none; }
        .search-box i { position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: var(--gray); }
        .filter-select { padding: 10px; border: 1px solid #cbd5e1; border-radius: var(--radius); min-width: 150px; }

        .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 25px; }
        .product-card { background: var(--white); border-radius: var(--radius); overflow: hidden; box-shadow: var(--shadow); transition: 0.3s; display: flex; flex-direction: column; }
        .product-card:hover { transform: translateY(-5px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
        .p-img { height: 200px; overflow: hidden; position: relative; background: #eee; }
        .p-img img { width: 100%; height: 100%; object-fit: cover; }
        .p-badge { position: absolute; top: 10px; right: 10px; background: var(--secondary); color: var(--white); padding: 4px 8px; font-size: 0.8rem; border-radius: 4px; font-weight: 600; }
        .p-details { padding: 15px; flex-grow: 1; display: flex; flex-direction: column; }
        .p-cat { color: var(--gray); font-size: 0.85rem; text-transform: uppercase; margin-bottom: 5px; }
        .p-title { font-weight: 600; margin-bottom: 10px; flex-grow: 1; }
        .p-meta { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .p-price { font-size: 1.2rem; font-weight: 700; color: var(--primary); }
        .p-rating { color: var(--secondary); font-size: 0.9rem; }
        .btn-block { width: 100%; justify-content: center; }

        /* --- Printer View --- */
        .printer-layout { display: grid; grid-template-columns: 1fr 1fr; gap: 40px; background: var(--white); padding: 30px; border-radius: var(--radius); box-shadow: var(--shadow); }
        .upload-area { border: 2px dashed #cbd5e1; border-radius: var(--radius); padding: 30px; text-align: center; cursor: pointer; transition: 0.3s; background: #f8fafc; }
        .upload-area:hover { border-color: var(--primary); background: #eff6ff; }
        .preview-box { margin-top: 20px; min-height: 200px; display: flex; align-items: center; justify-content: center; background: #eee; border-radius: var(--radius); overflow: hidden; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: 600; font-size: 0.9rem; }
        .form-control { width: 100%; padding: 10px; border: 1px solid #cbd5e1; border-radius: var(--radius); }

        /* --- Admin View --- */
        .admin-dashboard { background: var(--white); padding: 20px; border-radius: var(--radius); box-shadow: var(--shadow); margin-bottom: 30px; }
        .admin-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 20px; border-bottom: 1px solid #e2e8f0; }
        
        /* Income Cards */
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .stat-card { padding: 20px; border-radius: var(--radius); color: white; position: relative; overflow: hidden; }
        .stat-card h3 { font-size: 0.9rem; opacity: 0.9; margin-bottom: 5px; }
        .stat-card .value { font-size: 1.8rem; font-weight: 700; }
        .stat-card.income { background: linear-gradient(135deg, #3b82f6, #2563eb); }
        .stat-card.commission { background: linear-gradient(135deg, #10b981, #059669); }
        .stat-card.total { background: linear-gradient(135deg, #8b5cf6, #7c3aed); }
        .stat-card i { position: absolute; right: 15px; bottom: 15px; font-size: 3rem; opacity: 0.2; }

        .data-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        .data-table th, .data-table td { padding: 12px 15px; text-align: left; border-bottom: 1px solid #e2e8f0; }
        .data-table th { background: #f1f5f9; font-weight: 600; color: var(--dark); }
        .action-btns { display: flex; gap: 5px; }
        .btn-sm { padding: 5px 10px; font-size: 0.8rem; }

        /* --- Contact View --- */
        .contact-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 40px; }
        .contact-info-card { background: var(--primary); color: var(--white); padding: 30px; border-radius: var(--radius); }
        .info-item { margin-bottom: 20px; display: flex; align-items: center; gap: 15px; }
        .info-item i { font-size: 1.5rem; background: rgba(255,255,255,0.2); padding: 10px; border-radius: 50%; }

        /* --- Toast Notification --- */
        #toast-container { position: fixed; bottom: 20px; right: 20px; z-index: 2000; }
        .toast { background: var(--dark); color: var(--white); padding: 12px 24px; border-radius: var(--radius); margin-top: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.2); animation: slideIn 0.3s ease; display: flex; align-items: center; gap: 10px; min-width: 250px; }
        .toast.success { border-left: 5px solid var(--success); }
        .toast.error { border-left: 5px solid var(--danger); }
        @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }

        /* --- Modals --- */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1500; align-items: center; justify-content: center; }
        .modal.open { display: flex; }
        .modal-content { background: var(--white); width: 90%; max-width: 500px; padding: 25px; border-radius: var(--radius); position: relative; animation: fadeIn 0.3s; }
        .close-modal { position: absolute; top: 15px; right: 15px; font-size: 1.2rem; cursor: pointer; color: var(--gray); }
        .modal-title { margin-bottom: 20px; font-size: 1.4rem; border-bottom: 1px solid #eee; padding-bottom: 10px; text-align: center; }

        /* --- Footer --- */
        footer { background: var(--dark); color: var(--white); padding: 40px 0; margin-top: 60px; text-align: center; }
        .footer-links { display: flex; justify-content: center; gap: 20px; margin-bottom: 20px; }
        .footer-links a:hover { color: var(--secondary); }
        .admin-login-link { color: #475569; font-size: 0.8rem; margin-top: 15px; display: inline-block; text-decoration: underline; cursor: pointer; }
        .admin-login-link:hover { color: var(--white); }

        /* --- Utility Classes --- */
        .hidden-admin { display: none !important; }

        /* --- Responsive --- */
        @media (max-width: 768px) {
            .navbar { padding: 0 10px; }
            .nav-links { display: none; position: absolute; top: 70px; left: 0; width: 100%; background: var(--white); flex-direction: column; padding: 20px; box-shadow: var(--shadow); }
            .nav-links.active { display: flex; }
            .mobile-toggle { display: block; }
            .printer-layout, .contact-grid { grid-template-columns: 1fr; }
            .hero h1 { font-size: 1.8rem; }
        }
    </style>
</head>
<body>

    <!-- Notification Area -->
    <div id="toast-container"></div>

    <!-- Header -->
    <header>
        <div class="container navbar">
            <div class="logo" onclick="app.router('home')">MC <span>SELLING</span></div>
            <div class="mobile-toggle" onclick="toggleMenu()"><i class="fas fa-bars"></i></div>
            <nav class="nav-links">
                <a onclick="app.router('home')">Home</a>
                <a onclick="app.router('shop')">Shop</a>
                <a onclick="app.router('printer')">Custom Prints</a>
                <a onclick="app.router('contact')">Contact</a>
                <!-- Admin Link is hidden by default via 'hidden-admin' class -->
                <a id="nav-admin" class="hidden-admin" onclick="app.router('admin')" style="color: var(--primary);"><i class="fas fa-lock"></i> Admin</a>
            </nav>
        </div>
    </header>

    <main class="container">
        
        <!-- HOME VIEW -->
        <section id="home-view" class="view active">
            <div class="hero">
                <h1>Smart Shopping | Best Deals | Custom Print Solutions</h1>
                <p>Your one-stop destination for trending products and professional logo printing.</p>
                <button class="btn btn-secondary" onclick="app.router('shop')">Shop Now <i class="fas fa-arrow-right"></i></button>
                <button class="btn btn-outline" style="border-color: #fff; color: #fff; margin-left: 10px;" onclick="app.router('printer')">Design Your Own</button>
            </div>

            <h2 class="section-title">Browse Categories</h2>
            <div class="category-grid">
                <div class="cat-card" onclick="app.filterShop('Electronics')"><i class="fas fa-laptop"></i><h3>Electronics</h3></div>
                <div class="cat-card" onclick="app.filterShop('Fashion')"><i class="fas fa-tshirt"></i><h3>Fashion</h3></div>
                <div class="cat-card" onclick="app.filterShop('Home & Kitchen')"><i class="fas fa-blender"></i><h3>Home</h3></div>
                <div class="cat-card" onclick="app.filterShop('Printer & Accessories')"><i class="fas fa-print"></i><h3>Printers</h3></div>
                <div class="cat-card" onclick="app.filterShop('Gadgets')"><i class="fas fa-mobile-alt"></i><h3>Gadgets</h3></div>
                <div class="cat-card" onclick="app.filterShop('Trending')"><i class="fas fa-fire"></i><h3>Trending</h3></div>
            </div>

            <h2 class="section-title">Trending Products</h2>
            <div id="home-products" class="product-grid"></div>
        </section>

        <!-- SHOP VIEW -->
        <section id="shop-view" class="view">
            <h2 class="section-title">All Products</h2>
            <div class="toolbar">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="search-input" placeholder="Search products..." onkeyup="app.handleSearch()">
                </div>
                <select id="category-filter" class="filter-select" onchange="app.handleFilter()">
                    <option value="All">All Categories</option>
                    <option value="Electronics">Electronics</option>
                    <option value="Fashion">Fashion</option>
                    <option value="Home & Kitchen">Home & Kitchen</option>
                    <option value="Printer & Accessories">Printer & Accessories</option>
                    <option value="Gadgets">Gadgets</option>
                    <option value="Trending">Trending</option>
                    <option value="Custom Prints">Custom Prints</option>
                </select>
                <select id="sort-filter" class="filter-select" onchange="app.handleSort()">
                    <option value="default">Sort By: Default</option>
                    <option value="low-high">Price: Low to High</option>
                    <option value="high-low">Price: High to Low</option>
                </select>
            </div>
            <div id="shop-products" class="product-grid"></div>
        </section>

        <!-- PRINTER VIEW -->
        <section id="printer-view" class="view">
            <h2 class="section-title">Custom Logo & Print Design</h2>
            <p style="margin-bottom: 20px;">Upload your logo and customize your print on T-Shirts, Mugs, or Banners.</p>
            
            <div class="printer-layout">
                <div class="print-config">
                    <div class="form-group">
                        <label>Select Product Type</label>
                        <select class="form-control" id="print-type">
                            <option value="T-Shirt">T-Shirt Printing ($15.00)</option>
                            <option value="Mug">Mug Printing ($8.00)</option>
                            <option value="Banner">Banner Printing ($25.00)</option>
                            <option value="Business Card">Business Cards ($10.00)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Upload Your Logo / Image</label>
                        <div class="upload-area" onclick="document.getElementById('file-upload').click()">
                            <i class="fas fa-cloud-upload-alt" style="font-size: 2rem; color: var(--gray);"></i>
                            <p>Click to upload image</p>
                            <input type="file" id="file-upload" hidden accept="image/*" onchange="app.handleImageUpload(this)">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Additional Instructions</label>
                        <textarea class="form-control" rows="4" placeholder="E.g., Place logo on the center, white text..."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Contact Email for Order</label>
                        <input type="email" class="form-control" placeholder="your@email.com">
                    </div>
                    <button class="btn btn-primary btn-block" onclick="app.submitPrintOrder()">Send Inquiry</button>
                </div>

                <div class="print-preview">
                    <label>Live Preview</label>
                    <div class="preview-box" id="preview-container">
                        <p style="color: var(--gray);">Preview will appear here</p>
                    </div>
                    <div style="margin-top: 20px; padding: 15px; background: #e0f2fe; border-radius: var(--radius);">
                        <h4 style="color: #0369a1;">Why Choose Us?</h4>
                        <ul style="margin-left: 20px; margin-top: 10px; color: #334155;">
                            <li>High quality durable printing</li>
                            <li>Fast turnaround time</li>
                            <li>Custom vector logo design available</li>
                            <li>Bulk order discounts</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- ADMIN VIEW -->
        <section id="admin-view" class="view">
            <h2 class="section-title">Admin Dashboard</h2>
            
            <!-- INCOME STATS -->
            <div class="stats-grid">
                <div class="stat-card income">
                    <h3>Total Sales</h3>
                    <div class="value" id="stat-sales">$0.00</div>
                    <i class="fas fa-shopping-cart"></i>
                </div>
                <div class="stat-card commission">
                    <h3>Commission Earned</h3>
                    <div class="value" id="stat-commission">$0.00</div>
                    <i class="fas fa-coins"></i>
                </div>
                <div class="stat-card total">
                    <h3>Net Balance</h3>
                    <div class="value" id="stat-balance">$0.00</div>
                    <i class="fas fa-wallet"></i>
                </div>
            </div>

            <!-- INCOME ENTRY -->
            <div class="admin-dashboard">
                <div class="admin-header">
                    <h3>Add Sale Record</h3>
                    <button class="btn btn-secondary" onclick="app.openIncomeModal()"><i class="fas fa-plus"></i> Record Sale</button>
                </div>
                <p style="margin-bottom: 15px; color: var(--gray);">Manually record sales from Amazon, Daraz, or Alibaba here.</p>
                
                <div style="overflow-x: auto;">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Product / Item</th>
                                <th>Sale Amount</th>
                                <th>Commission</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="income-list"></tbody>
                    </table>
                </div>
            </div>

            <!-- PRODUCT MANAGEMENT -->
            <div class="admin-dashboard">
                <div class="admin-header">
                    <h3>Product Management</h3>
                    <div style="display:flex; gap:10px;">
                        <button class="btn btn-danger" onclick="app.logout()">Logout</button>
                        <button class="btn btn-primary" onclick="app.openModal()"><i class="fas fa-plus"></i> Add Product</button>
                    </div>
                </div>
                
                <div style="overflow-x: auto;">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Image</th>
                                <th>Product Name</th>
                                <th>Category</th>
                                <th>Price</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="admin-product-list"></tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- CONTACT VIEW -->
        <section id="contact-view" class="view">
            <h2 class="section-title">Get In Touch</h2>
            <div class="contact-grid">
                <div class="contact-info-card">
                    <h3>Contact Information</h3>
                    <p style="margin-bottom: 30px; opacity: 0.9;">Have questions about an order or custom printing? Reach out to us!</p>
                    <div class="info-item">
                        <i class="fas fa-envelope"></i>
                        <div><h4>Email</h4><p>charujilla01@gmail.com</p></div>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-phone"></i>
                        <div><h4>Phone</h4><p>+94 783 592 461</p></div>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-map-marker-alt"></i>
                        <div><h4>Location</h4><p>Sri Lanka (Global Shipping Available)</p></div>
                    </div>
                </div>
                <div style="background: white; padding: 30px; border-radius: var(--radius); box-shadow: var(--shadow);">
                    <h3>Send a Message</h3>
                    <form onsubmit="event.preventDefault(); app.submitContact();">
                        <div class="form-group"><label>Name</label><input type="text" class="form-control" required></div>
                        <div class="form-group"><label>Email</label><input type="email" class="form-control" required></div>
                        <div class="form-group"><label>Message</label><textarea class="form-control" rows="5" required></textarea></div>
                        <button type="submit" class="btn btn-primary">Send Message</button>
                    </form>
                </div>
            </div>
        </section>
    </main>

    <!-- LOGIN MODAL -->
    <div id="login-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="app.closeLoginModal()">&times;</span>
            <h3 class="modal-title">Admin Login</h3>
            <form onsubmit="event.preventDefault(); app.attemptLogin();">
                <div class="form-group">
                    <label>Username</label>
                    <input type="text" id="login-user" class="form-control" placeholder="Enter username">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="login-pass" class="form-control" placeholder="Enter password">
                </div>
                <button type="submit" class="btn btn-primary btn-block">Login</button>
            </form>
        </div>
    </div>

    <!-- PRODUCT MODAL -->
    <div id="product-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="app.closeModal()">&times;</span>
            <h3 class="modal-title" id="modal-title">Add Product</h3>
            <form id="product-form" onsubmit="event.preventDefault(); app.saveProduct();">
                <input type="hidden" id="p-id">
                <div class="form-group"><label>Product Name</label><input type="text" id="p-name" class="form-control" required></div>
                <div class="form-group"><label>Image URL</label><input type="url" id="p-image" class="form-control" placeholder="https://..." required></div>
                <div class="form-group" style="display: flex; gap: 10px;">
                    <div style="flex:1;"><label>Price ($)</label><input type="number" id="p-price" class="form-control" step="0.01" required></div>
                    <div style="flex:1;"><label>Category</label>
                        <select id="p-category" class="form-control">
                            <option>Electronics</option><option>Fashion</option><option>Home & Kitchen</option>
                            <option>Printer & Accessories</option><option>Custom Prints</option><option>Gadgets</option><option>Trending</option>
                        </select>
                    </div>
                </div>
                <div class="form-group"><label>Affiliate Link</label><input type="url" id="p-link" class="form-control" placeholder="https://amazon.com/..." required></div>
                <button type="submit" class="btn btn-primary btn-block">Save Product</button>
            </form>
        </div>
    </div>

    <!-- INCOME MODAL -->
    <div id="income-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="app.closeIncomeModal()">&times;</span>
            <h3 class="modal-title">Record New Sale</h3>
            <form onsubmit="event.preventDefault(); app.saveIncomeRecord();">
                <div class="form-group"><label>Product / Item Name</label><input type="text" id="inc-item" class="form-control" placeholder="e.g. Sony Headphones" required></div>
                <div class="form-group" style="display: flex; gap: 10px;">
                    <div style="flex:1;"><label>Sale Amount ($)</label><input type="number" id="inc-amount" class="form-control" step="0.01" required></div>
                    <div style="flex:1;"><label>Your Commission ($)</label><input type="number" id="inc-commission" class="form-control" step="0.01" required></div>
                </div>
                <button type="submit" class="btn btn-primary btn-block">Save Record</button>
            </form>
        </div>
    </div>

    <footer>
        <div class="container">
            <div class="footer-links">
                <a onclick="app.router('home')">Home</a><a onclick="app.router('shop')">Shop</a>
                <a onclick="app.router('printer')">Printing</a><a onclick="app.router('contact')">Contact</a>
            </div>
            <p>&copy; 2023 MC SELLING. All Rights Reserved.</p>
            <p style="font-size: 0.8rem; color: #64748b; margin-top: 10px;">Affiliate Disclosure: We earn from qualifying purchases.</p>
            
            <!-- DISCREET ADMIN LOGIN LINK (Only visible in footer) -->
            <a class="admin-login-link" onclick="app.checkAdminAccess()">Admin Login</a>
        </div>
    </footer>

    <script>
        // --- CONFIG & CREDENTIALS ---
        const ADMIN_USER = "charu&mili";
        const ADMIN_PASS = "milinda0521@";
        const STORAGE_KEY_PRODUCTS = 'mc_selling_products';
        const STORAGE_KEY_INCOME = 'mc_selling_income';

        // Default Data
        const defaultProducts = [
            { id: 1, name: "Wireless Bluetooth Headphones", category: "Electronics", price: 45.00, rating: 4.5, image: "https://picsum.photos/seed/headphone/300/300", link: "#" },
            { id: 2, name: "Smart Fitness Watch", category: "Gadgets", price: 29.99, rating: 4.2, image: "https://picsum.photos/seed/watch/300/300", link: "#" },
            { id: 3, name: "Custom Logo T-Shirt", category: "Custom Prints", price: 15.00, rating: 5.0, image: "https://picsum.photos/seed/tshirt/300/300", link: "#" },
            { id: 4, name: "Ergonomic Office Chair", category: "Home & Kitchen", price: 120.00, rating: 4.8, image: "https://picsum.photos/seed/chair/300/300", link: "#" },
            { id: 5, name: "4K Monitor 27 inch", category: "Electronics", price: 299.00, rating: 4.7, image: "https://picsum.photos/seed/monitor/300/300", link: "#" },
            { id: 6, name: "Trendy Summer Hoodie", category: "Fashion", price: 35.50, rating: 4.3, image: "https://picsum.photos/seed/hoodie/300/300", link: "#" },
            { id: 7, name: "Inkjet Printer Multi-function", category: "Printer & Accessories", price: 89.00, rating: 4.0, image: "https://picsum.photos/seed/printer/300/300", link: "#" },
            { id: 8, name: "Portable Power Bank 20000mAh", category: "Trending", price: 25.00, rating: 4.6, image: "https://picsum.photos/seed/power/300/300", link: "#" },
        ];

        // --- APP CONTROLLER ---
        const app = {
            products: [],
            incomeRecords: [],

            init: function() {
                // Load Products
                const storedP = localStorage.getItem(STORAGE_KEY_PRODUCTS);
                this.products = storedP ? JSON.parse(storedP) : defaultProducts;
                
                // Load Income
                const storedI = localStorage.getItem(STORAGE_KEY_INCOME);
                this.incomeRecords = storedI ? JSON.parse(storedI) : [];

                this.saveToStorage();
                this.renderHomeProducts();
                this.renderShopProducts(this.products);
                this.renderAdminTable();
                this.renderIncomeStats();
                this.renderIncomeList();
                
                // Check Login Status to show/hide Admin Nav Link
                this.updateAdminVisibility();
            },

            saveToStorage: function() {
                localStorage.setItem(STORAGE_KEY_PRODUCTS, JSON.stringify(this.products));
                localStorage.setItem(STORAGE_KEY_INCOME, JSON.stringify(this.incomeRecords));
            },

            // --- AUTHENTICATION & VISIBILITY ---
            updateAdminVisibility: function() {
                const isLoggedIn = sessionStorage.getItem('isAdmin');
                const adminLink = document.getElementById('nav-admin');
                if (isLoggedIn === 'true') {
                    adminLink.classList.remove('hidden-admin');
                } else {
                    adminLink.classList.add('hidden-admin');
                }
            },

            checkAdminAccess: function() {
                const isLoggedIn = sessionStorage.getItem('isAdmin');
                if (isLoggedIn === 'true') {
                    this.router('admin');
                } else {
                    document.getElementById('login-modal').classList.add('open');
                }
            },

            attemptLogin: function() {
                const u = document.getElementById('login-user').value;
                const p = document.getElementById('login-pass').value;

                if (u === ADMIN_USER && p === ADMIN_PASS) {
                    sessionStorage.setItem('isAdmin', 'true');
                    this.showToast('Login Successful!', 'success');
                    this.closeLoginModal();
                    this.updateAdminVisibility(); // Show Admin Link in Nav
                    this.router('admin');
                    document.getElementById('login-user').value = '';
                    document.getElementById('login-pass').value = '';
                } else {
                    this.showToast('Invalid Username or Password', 'error');
                }
            },

            logout: function() {
                sessionStorage.removeItem('isAdmin');
                this.showToast('Logged out successfully', 'success');
                this.updateAdminVisibility(); // Hide Admin Link in Nav
                this.router('home');
            },

            closeLoginModal: function() { document.getElementById('login-modal').classList.remove('open'); },

            // --- NAVIGATION ---
            router: function(viewId) {
                document.querySelectorAll('.view').forEach(el => el.classList.remove('active'));
                document.querySelectorAll('.nav-links a').forEach(el => el.classList.remove('active'));
                
                document.getElementById(viewId + '-view').classList.add('active');
                
                document.querySelectorAll('.nav-links a').forEach(link => {
                    // Only set active class if link is visible
                    if (link.style.display !== 'none' && link.getAttribute('onclick').includes(viewId)) {
                        link.classList.add('active');
                    }
                });
                window.scrollTo(0, 0);
                document.querySelector('.nav-links').classList.remove('active');
            },

            filterShop: function(category) {
                this.router('shop');
                document.getElementById('category-filter').value = category;
                this.handleFilter();
            },

            // --- RENDERING PRODUCTS ---
            createProductCard: function(product) {
                return `
                    <div class="product-card">
                        <div class="p-img">
                            <span class="p-badge">${product.category}</span>
                            <img src="${product.image}" alt="${product.name}">
                        </div>
                        <div class="p-details">
                            <div class="p-cat">${product.category}</div>
                            <h3 class="p-title">${product.name}</h3>
                            <div class="p-meta">
                                <span class="p-price">$${parseFloat(product.price).toFixed(2)}</span>
                                <span class="p-rating"><i class="fas fa-star"></i> ${product.rating}</span>
                            </div>
                            <a href="${product.link}" target="_blank" class="btn btn-primary btn-block">
                                Buy Now <i class="fas fa-external-link-alt"></i>
                            </a>
                        </div>
                    </div>
                `;
            },

            renderHomeProducts: function() {
                const container = document.getElementById('home-products');
                container.innerHTML = this.products.slice(0, 4).map(p => this.createProductCard(p)).join('');
            },

            renderShopProducts: function(list) {
                const container = document.getElementById('shop-products');
                if(list.length === 0) { container.innerHTML = `<p style="grid-column: 1/-1; text-align: center; padding: 20px;">No products found.</p>`; return; }
                container.innerHTML = list.map(p => this.createProductCard(p)).join('');
            },

            renderAdminTable: function() {
                const tbody = document.getElementById('admin-product-list');
                tbody.innerHTML = this.products.map(p => `
                    <tr>
                        <td><img src="${p.image}" style="width: 40px; height: 40px; border-radius: 4px; object-fit: cover;"></td>
                        <td>${p.name}</td>
                        <td>${p.category}</td>
                        <td>$${parseFloat(p.price).toFixed(2)}</td>
                        <td><div class="action-btns"><button class="btn btn-sm btn-secondary" onclick="app.editProduct(${p.id})"><i class="fas fa-edit"></i></button><button class="btn btn-sm btn-danger" onclick="app.deleteProduct(${p.id})"><i class="fas fa-trash"></i></button></div></td>
                    </tr>
                `).join('');
            },

            // --- FILTERING & SEARCH ---
            getFilteredProducts: function() {
                const search = document.getElementById('search-input').value.toLowerCase();
                const category = document.getElementById('category-filter').value;
                const sort = document.getElementById('sort-filter').value;

                let filtered = this.products.filter(p => {
                    const matchesSearch = p.name.toLowerCase().includes(search);
                    const matchesCategory = category === 'All' || p.category === category;
                    return matchesSearch && matchesCategory;
                });

                if (sort === 'low-high') filtered.sort((a, b) => a.price - b.price);
                else if (sort === 'high-low') filtered.sort((a, b) => b.price - a.price);
                return filtered;
            },

            handleSearch: function() { this.renderShopProducts(this.getFilteredProducts()); },
            handleFilter: function() { this.renderShopProducts(this.getFilteredProducts()); },
            handleSort: function() { this.renderShopProducts(this.getFilteredProducts()); },

            // --- INCOME TRACKING LOGIC ---
            renderIncomeStats: function() {
                let totalSales = 0;
                let totalCommission = 0;

                this.incomeRecords.forEach(rec => {
                    totalSales += parseFloat(rec.amount);
                    totalCommission += parseFloat(rec.commission);
                });

                document.getElementById('stat-sales').innerText = '$' + totalSales.toFixed(2);
                document.getElementById('stat-commission').innerText = '$' + totalCommission.toFixed(2);
                document.getElementById('stat-balance').innerText = '$' + totalCommission.toFixed(2);
            },

            renderIncomeList: function() {
                const tbody = document.getElementById('income-list');
                if (this.incomeRecords.length === 0) {
                    tbody.innerHTML = `<tr><td colspan="5" style="text-align:center;">No records found.</td></tr>`;
                    return;
                }
                const sorted = [...this.incomeRecords].reverse();
                tbody.innerHTML = sorted.map(rec => `
                    <tr>
                        <td>${rec.date}</td>
                        <td>${rec.item}</td>
                        <td>$${parseFloat(rec.amount).toFixed(2)}</td>
                        <td style="color: var(--success); font-weight:bold;">+$${parseFloat(rec.commission).toFixed(2)}</td>
                        <td><button class="btn btn-sm btn-danger" onclick="app.deleteIncome(${rec.id})"><i class="fas fa-trash"></i></button></td>
                    </tr>
                `).join('');
            },

            openIncomeModal: function() {
                document.getElementById('inc-item').value = '';
                document.getElementById('inc-amount').value = '';
                document.getElementById('inc-commission').value = '';
                document.getElementById('income-modal').classList.add('open');
            },
            closeIncomeModal: function() { document.getElementById('income-modal').classList.remove('open'); },

            saveIncomeRecord: function() {
                const item = document.getElementById('inc-item').value;
                const amount = document.getElementById('inc-amount').value;
                const commission = document.getElementById('inc-commission').value;
                const date = new Date().toLocaleDateString();

                const newRecord = { id: Date.now(), date, item, amount, commission };
                this.incomeRecords.push(newRecord);
                this.saveToStorage();
                this.renderIncomeStats();
                this.renderIncomeList();
                this.closeIncomeModal();
                this.showToast('Income Recorded Successfully', 'success');
            },

            deleteIncome: function(id) {
                if(confirm('Delete this record?')) {
                    this.incomeRecords = this.incomeRecords.filter(r => r.id !== id);
                    this.saveToStorage();
                    this.renderIncomeStats();
                    this.renderIncomeList();
                    this.showToast('Record Deleted', 'error');
                }
            },

            // --- PRODUCT CRUD ---
            openModal: function() {
                document.getElementById('product-form').reset();
                document.getElementById('p-id').value = '';
                document.getElementById('modal-title').innerText = 'Add Product';
                document.getElementById('product-modal').classList.add('open');
            },
            closeModal: function() { document.getElementById('product-modal').classList.remove('open'); },

            saveProduct: function() {
                const id = document.getElementById('p-id').value;
                const name = document.getElementById('p-name').value;
                const image = document.getElementById('p-image').value;
                const price = document.getElementById('p-price').value;
                const category = document.getElementById('p-category').value;
                const link = document.getElementById('p-link').value;

                if (id) {
                    const index = this.products.findIndex(p => p.id == id);
                    if (index !== -1) { this.products[index] = { ...this.products[index], name, image, price, category, link }; this.showToast('Product updated!', 'success'); }
                } else {
                    const newProduct = { id: Date.now(), name, image, price, category, link, rating: 5.0 };
                    this.products.push(newProduct);
                    this.showToast('Product added!', 'success');
                }
                this.saveToStorage();
                this.renderShopProducts(this.products);
                this.renderHomeProducts();
                this.renderAdminTable();
                this.closeModal();
            },

            editProduct: function(id) {
                const product = this.products.find(p => p.id === id);
                if (product) {
                    document.getElementById('p-id').value = product.id;
                    document.getElementById('p-name').value = product.name;
                    document.getElementById('p-image').value = product.image;
                    document.getElementById('p-price').value = product.price;
                    document.getElementById('p-category').value = product.category;
                    document.getElementById('p-link').value = product.link;
                    document.getElementById('modal-title').innerText = 'Edit Product';
                    document.getElementById('product-modal').classList.add('open');
                }
            },

            deleteProduct: function(id) {
                if(confirm('Delete this product?')) {
                    this.products = this.products.filter(p => p.id !== id);
                    this.saveToStorage();
                    this.renderShopProducts(this.getFilteredProducts());
                    this.renderHomeProducts();
                    this.renderAdminTable();
                    this.showToast('Product deleted.', 'error');
                }
            },

            // --- PRINTER & CONTACT ---
            handleImageUpload: function(input) {
                if (input.files && input.files[0]) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        document.getElementById('preview-container').innerHTML = `<img src="${e.target.result}" style="max-height: 100%; max-width: 100%;">`;
                    }
                    reader.readAsDataURL(input.files[0]);
                }
            },
            submitPrintOrder: function() {
                this.showToast(`Inquiry sent successfully!`, 'success');
                document.getElementById('file-upload').value = "";
                document.getElementById('preview-container').innerHTML = `<p style="color: var(--gray);">Preview will appear here</p>`;
            },
            submitContact: function() {
                this.showToast('Message sent! We will reply shortly.', 'success');
                document.querySelector('#contact-view form').reset();
            },

            // --- UTILS ---
            showToast: function(msg, type = 'success') {
                const container = document.getElementById('toast-container');
                const toast = document.createElement('div');
                toast.className = `toast ${type}`;
                toast.innerHTML = `<i class="fas ${type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle'}"></i> ${msg}`;
                container.appendChild(toast);
                setTimeout(() => { toast.style.opacity = '0'; setTimeout(() => toast.remove(), 300); }, 3000);
            }
        };

        function toggleMenu() { document.querySelector('.nav-links').classList.toggle('active'); }
        document.addEventListener('DOMContentLoaded', () => { app.init(); });
    </script>
</body>
</html>